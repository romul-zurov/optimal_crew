если экипаж, приписанный к заказу, имеет состояние "недоступен", то что?
если экипаж уже назначен на заказ, то считать ли его для нового заказа или
	отбрасывать?

экипаж, взявший предварительный заказ (предварительный экипаж):  ORDERS.PRIOR_CREW_ID
	- м.б. только у предварительного заказа (ORDERS.IS_PRIOR = 1)
    в 99% он и становится ORDERS.CREWID

интерфейс а-ля "такси-мастер"!!!
	настройки колонок сохраняются в таблице USERS в полях:
    	NAME - имя пользователя
        LOGIN - тип пользвателя (OPERATOR, DISPATCHER и т.д.)
        STARTTIME, FINISHTIME - выход на/окончание смены
        SETTINGS - собственно настройки

проверять свободные экипажи на приписанность к предварительному заказу
	и просчитывать, успеет ли экипаж выполнить текущий заказ и вовремя приехать
    на предварительный. на изменение "пробок"накидывать 20минут.


при просчёте нового заказа сначала считать маршрут для want_crewId  !

если экипаж на заказе клиента забрал и высадил, то заказ "завершён" !

просчитывать текущий заказ только если время подачи раньше текущего ??




состояние экипажа = CREWS.STATE !
класс хттп-запроса?
запрос координат АП --> TCrewList

маршрут для "занятых" экипажей;
асинхронные запросы ??!!!;
два grid - списка : рабочие экипажи и просчитанные !;
статусы !;


общий алгоритм:

1. определить заказ ?!
2. получить gps-координаты для адреса подачи (АП);
3. найти рабочие экипажи, отсортировать их по расстоянию;
4. считать время проезда машин к АП, сортировать по времени, выводить на экран
	по мере просчёта;
	на экран выводить ID экипажа, код и время до АП;

необходимые функции:
- определение заказа (нового, текущего, как-то ещё)?
- выделение АП из заказа;
- определяем жпсК для АП;
- поиск рабочих экипажей:
	- список трек-точек за последние 30 минут (час, 10 минут?);
	- список экипажей трек-списка
	- список экипажей в состоянии "свободен" (1) и "занят" (3);
	- список текущих (свежайших) координат для рабочих экипажей;
	- расчёт расстояний рабочих экипажей до АП, список, сортировка;
	!на выходе имеем список рабочих экипажей, сортированных по расстоянию до АП;
- расчёт времени проезда экипажа до АП:
	- если свободен, то формируем маршрут "координата -- АП" и запрашиваем время;
	- если занят:
    	- определяем заказ, на котором экипаж занят;
        - составляем список точек остановок: начальной, промежуточных и конечной;
        - получаем жпс-координаты первой точки, смотрим трек - если был, то
        	переходим к следующей, если нет, формируем маршрут:
            	тек. коорд - точки останова - АП
                определяем время этого маршрута
                прибавляем по 10 минут на точки кроме высадки (3мин)
	- заносим в список экипаж, время подачи





- если у заказа есть want_crew и prior_crew, то что ??						ok
	- want_crew не используется
- желаемый экипаж: ORDERS.WANTCREWID   - НЕ ИСПОЛЬЗУЕТСЯ!! 					ok
- радиус "попадания" сделать 150м 											ok
- исправлен вторичный просчёт gps-координаты адреса в маршруте заказа 		ok
- запрос времени и маршрута --> TCrew										ok
- написана ф-ия replace_time, позволяет брать время в плюс от текущего		ok
- отброс эвакуаторов - НЕ НАДО!												ok
- результирующий список фильтровать по времени подачи !;					ok
- разделить рабочий и результирующий список !;								ok
- запрос состояния экипажей - брать последнее !								ok
- РАСЧЁТ ВРЕМЕНИ МАРШРУТА ДО АП !;											ok
- СОРТИРОВКА СПИСКА ЭКИПАЖЕЙ ПО РАССТОЯНИЮ ДО АП И СОСТОЯНИЮ !;				ok
- ФУНКЦИЯ РАССТОЯНИЯ ЭКИПАЖА ДО АП !;										ok
- ФУНКЦИЯ - БЫЛА ЛИ МАШИНА В ЗАДАНОЙ ТОЧКЕ !;								ok
- ОТСОРТИРОВАТЬ КООРДИНАТЫ ПО ВРЕМЕНИ В CREW_LIST!							ok
- запрос даты сделать в формате YYYY-MM-DD !								ok

- replace dataset to ibquery;												OK
- добавить время к координатам экипажей, отсортировать по времени;			OK
- запрос работающих экипажей (1 и 3) ID, NAME, GPSID;						ok??
        	почему в таблице crews_coords есть экипажи, GpsId которых
            _отсутствует_ в таблице crews?
- функция, возращающая текущие (последние) кооринаты экипажа;
- запрос адресов заказов, выполнямых занятыми экипажами;					ok
- функция, прибавляющая время на остановки занятого экипажа по
		(не)посещённым адресам;
- функция, возвращающая GPS-координаты по адресу							ok
- функция, возвращающая время маршрута;
- функция расчёта расстояния (прямого) между 2 жпс-точками;					ok


